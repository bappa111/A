<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Chat</title>
</head>
<body>

<h2>Chat</h2>

<div style="display:flex; gap:20px;">

  <!-- LEFT SIDE : FRIENDS + USERS -->
  <div style="width:30%; border-right:1px solid #ccc; padding-right:10px;">

    <h3>Friends</h3>
    <ul id="friends"></ul>

    <h3>Users</h3>
    <ul id="users"></ul>

  </div>

  <!-- RIGHT SIDE : CHAT AREA -->
  <div style="width:70%; padding-left:10px;">

    <h4 id="chatWith"></h4>

    <div id="messages" style="min-height:200px; border:1px solid #ddd; padding:6px; margin-bottom:8px;"></div>

    <!-- MESSAGE INPUT -->
    <input id="msg" placeholder="Message">
    <button onclick="sendMessage()">Send</button>

    <!-- ATTACH BUTTON -->
    <button id="attachBtn">â•</button>

    <div id="attachMenu" style="display:none; margin-top:6px;">
      <button onclick="document.getElementById('imageInput').click()">ğŸ“· Image</button>
      <button onclick="document.getElementById('videoInput').click()">ğŸ¥ Video</button>
      <button onclick="startVoice()">ğŸ™ï¸ Voice</button>
    </div>

    <!-- HIDDEN FILE INPUTS -->
    <input
      type="file"
      id="imageInput"
      accept="image/*"
      hidden
      onchange="handleImageChange(event)"
    >

    <input
      type="file"
      id="videoInput"
      accept="video/*"
      hidden
      onchange="handleVideoChange(event)"
    >

    <!-- VOICE CONTROL -->
    <br><br>
    <button onclick="stopVoice()">â¹ï¸ Stop Voice</button>

  </div>

</div>

<!-- UPLOAD PROGRESS OVERLAY -->
<div id="uploadOverlay" style="
  display:none;
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  background:rgba(0,0,0,0.5);
  z-index:99999;
  align-items:center;
  justify-content:center;
">
  <div style="
    width:120px;
    height:120px;
    border-radius:50%;
    border:10px solid #ddd;
    border-top:10px solid #4caf50;
    animation:spin 1s linear infinite;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:20px;
    background:#fff;
  ">
    <span id="uploadPercent">0%</span>
  </div>
</div>

<style>
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>

<script src="https://cdn.socket.io/4.8.1/socket.io.min.js"></script>
<script src="app.js"></script>

<script>
  // toggle attach menu (ONLY ONCE)
  document.getElementById("attachBtn").onclick = () => {
    const menu = document.getElementById("attachMenu");
    menu.style.display = menu.style.display === "none" ? "block" : "none";
  };
</script>

</body>
</html>
